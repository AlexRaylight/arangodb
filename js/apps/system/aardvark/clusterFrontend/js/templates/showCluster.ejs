<script id="showCluster.ejs" type="text/template">
<% var statusClass = function(s) {
    switch (s) {
      case "ok":
        return "success";
      case "warning": 
        return "warning";
      case "critical":
        return "danger";
      case "missing":
        return "inactive";
    }
  };
%>
<ul class="thumbnails2">
  <div class="headerBar">
    <a class="arangoHeader">Cluster Dashboard</a>
    <div class="headerButtonBar pull-right">
      <select id="selectDB">
        <% _.each(dbs, function(d) { %>
          <option id="<%=d%>" <%=(d === "_system")?"checked":""%> ><%=d%></option>
        <% }); %>
      </select>
      <select id="selectCol">
      </select>
    </div>
  </div>
</ul>
<ul id="clusterLayout" class="tileList">
  <% if(type === "testPlan") { 
    _.each(byAddress, function(s, a) { 
      _.each(s.coords, function(c) {
      console.log(c);
    %>
      <li class="tile">
        <div class="coordinator <%=statusClass(c.get('status'))%>" id="<%=c.get('address')%>">
          <span class="clusterInfoIcon icon_arangodb_compass"></span>
        </div>
        <h5 class="collectionName"><%=c.get("name")%></h5>
      </li>
    <%
      });
      _.each(s.dbs, function(c) {
    %>
      <li class="tile">
        <div class="dbserver <%=statusClass(c.get('status'))%>" id="<%=c.get('address')%>">
          <span class="clusterInfoIcon icon_arangodb_database1"></span>
        </div>
        <h5 class="collectionName"><%=c.get("name")%> (Shards: <span id="<%=c.get("name")%>Shards" class="shardCounter"/>)</h5>
      </li>
    <%
        });
      });
    } else { 
      _.each(byAddress, function(s, a) { 
  %>
      <li class="tile">
        <% _.each(s.coords, function(c) { %>
          <div class="coordinator <%=statusClass(c.get('status'))%>" id="<%=c.get('address')%>">
            <span class="clusterInfoIcon icon_arangodb_compass"></span>
            <h6 class="serverName"><%=c.get("name")%></h6>
          </div>
        <% });
          var dbName = "";
          _.each(s.dbs, function(c) {
            dbName = c.get("name");
        %>
          <div class="dbserver <%=statusClass(c.get('status'))%>" id="<%=c.get('address')%>">
            <span class="clusterInfoIcon icon_arangodb_database1"></span>
            <h6 class="serverName"><%=c.get("name")%></h6>
          </div>
        <% }); %>
      <h5 class="collectionName"><%=a%> <%=dbName!==""?"(Shards: <span id=\"" + dbName + "Shards\"/>)":""%></h5>
      </li>
    <%
    });
  }
  %>
  <li><button id="clusterShutdown" class="button-danger pull-right">Shutdown Cluster</button></li>
</ul>

<div class="headerBar">
  <a class="arangoHeader">Cluster Statistics</a>
</div>
<div id="clusterGraphs">

</div>
<div id="lineGraph">

</div>
</script>
