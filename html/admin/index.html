<html>
	<head>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<link rel="shortcut icon" type="image/ico" href="favicon.ico" />
			<link rel="stylesheet" type="text/css" href="css/styles.css">
			<title>Avocado DB - Table Example</title>
			<style type="text/css" title="screen">
                        @import "css/demo_page.css";  
                        @import "css/demo_table_jui.css";
                        @import "css/jquery-ui-1.7.2.custom.css";
			
			body { background-color:#4C4949 }
			
			ul#sliding-navigation {
			  position: absolute;
			  top: 20px;
			  left: 0px;
			  width: 190px;
			}
			
			ul#table-view {
			  margin-left: 200px;
			}
				
			</style>
				<script type="text/javascript" language="javascript" src="script/jquery.js"></script>
				<script type="text/javascript" language="javascript" src="script/jquery.dataTables.js"></script>
				<script type="text/javascript" charset="utf-8">	</script>
	</head>
	


	<body>
	<h3 style="color:white">Database:</h3>
	
	<ul id="sliding-navigation">
          <li class="sliding-element"><h3 id="navelement1" style="color:black">Navigation Title #1</h3></li>  
          <li class="sliding-element"><a href="#">Link 1</a></li>  
          <li class="sliding-element"><a href="#">Link 2</a></li>  
          <li class="sliding-element"><h3 id="navelement2" style="color:black">Navigation Title #2</h3></li>  
          <li class="sliding-element"><a href="#">Link 3</a></li>  
          <li class="sliding-element"><a href="#">Link 4</a></li>  
        </ul>  


	<script>
		
		function fnFormatDetails ( oTable, nTr ) {
    			var aData = oTable.fnGetData( nTr );
    			var sOut = '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">';
    			sOut += '<tr><td>Rendering engine:</td><td>'+aaData[1]+' '+aaData[4]+'</td></tr>';
    			sOut += '<tr><td>Link to source:</td><td>Could provide a link here</td></tr>';
    			sOut += '<tr><td>Extra info:</td><td>And any further details here (images etc)</td></tr>';
    			sOut += '</table>';
     
    		return sOut;
		}



		$(document).ready(function() {
			

			var nCloneTh = document.createElement( 'th' );
    			var nCloneTd = document.createElement( 'td' );
    			nCloneTd.innerHTML = '<img src="images/details_open.png">';
    			nCloneTd.className = "center";
     
   	 		$('#example thead tr').each( function () {
        		this.insertBefore( nCloneTh, this.childNodes[0] );
    			} );
     
    			$('#example tbody tr').each( function () {
        		this.insertBefore(  nCloneTd.cloneNode( true ), this.childNodes[0] );
    			} );



			$.getJSON("http://localhost:8530/_system/collections", function(data) {
                        	
				var items=[];
				document.getElementById('ueberschrift').innerHTML="Directory:  " + data.path;
	
				$.each(data.collections, function(key, val) {
					var temp_status=val.status;
					
					if (temp_status == 2) {
						temp_status = "loaded";
					}
					
					items.push(["", val.id, val.name, temp_status]);
			    	});

				var oTable = $('#example').dataTable({
					"sPaginationType": "full_numbers",
					"bJQueryUI": true,
					"aoColumnDefs": [
							{"bSortable": false, "aTargets": [0] }
							],
					"aaSorting": [[1, 'asc']],
					"aaData": items
				});
			});
				
			$('#example tbody td img').live('click', function () {
        			var nTr = this.parentNode.parentNode;
        			if ( this.src.match('details_close') ) {
            				this.src = "images/details_open.png";
            				oTable.fnClose( nTr );
        				}
        			else {
            				this.src = "images/details_close.png";
            				oTable.fnOpen( nTr, fnFormatDetails(oTable, nTr), 'details' );
        			}
    			} );

		});
		
	</script>
	
	<ul id="table-view">
	<h3 id="ueberschrift" style="color:white">Directory:</h3>
	  <table cellpadding="0" cellspacing="0" border="0" class="display" id="example">
	    <thead>
	      <tr>
	        <th>ID</th>
                <th>Name</th>
                <th>Status</th>
                <th>Datafiles</th>
                <th>Size Documents</th>
	      </tr>
            </thead>
	</ul>
</body>
</html>
