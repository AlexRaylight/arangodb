dnl -*- mode: Autoconf; -*-

dnl ----------------------------------------------------------------------------
dnl --SECTION--                                                             ICU
dnl ----------------------------------------------------------------------------

AC_MSG_NOTICE([--------------------------------------------------------------------------------])
AC_MSG_NOTICE([CHECKING FOR ICU])
AC_MSG_NOTICE([--------------------------------------------------------------------------------])

AC_LANG(C)

AC_ARG_ENABLE(icu,
  AS_HELP_STRING([--enable-icu], [enable ICU support (default: false)]),
  tr_ICU="$enableval",
  tr_ICU="maybe"
)

AC_ARG_WITH(ICU,
  AS_HELP_STRING([--with-icu=DIR], [where the ICU library and includes are located]),
  [ICU_CPPFLAGS="-I$withval/include"
   ICU_LDFLAGS="-L$withval/lib"
   ICU="$withval"]
)

AC_ARG_WITH(ICU-lib,
  AS_HELP_STRING([--with-icu-lib=DIR], [where the ICU library is located]),
  [ICU_LDFLAGS="-L$withval"]
)

TR_STATIC_ENABLE([ICU])

if test "x$tr_ICU" = xyes;  then

  AC_MSG_NOTICE([--------------------------------------------------------------------------------])
  AC_MSG_NOTICE([CHECKING FOR ICU])
  AC_MSG_NOTICE([--------------------------------------------------------------------------------])

  dnl ----------------------------------------------------------------------------
  dnl checks for the icu-config
  dnl ----------------------------------------------------------------------------

  ICU_CONFIG="icu-config"

  if $ICU_CONFIG --version > /dev/null 2>&1; then
    ICU_CPPFLAGS="$($ICU_CONFIG --cppflags)"
    ICU_LDFLAGS="$($ICU_CONFIG --ldflags)"
    ICU_LIBS=""    
    TRI_ICU_VERSION="$($ICU_CONFIG --version)"
  else
    ICU_CPPFLAGS="$ICU_CPPFLAGS"
    ICU_LDFLAGS="$ICU_LDFLAGS"
    ICU_LIBS="-licui18n -licuuc -licudata  -licuio -licule -liculx"
    TRI_ICU_VERSION="unknown"
  fi

  ICU_CPPFLAGS="${ICU_CPPFLAGS} -DTRI_ICU_VERSION='\"${TRI_ICU_VERSION}\"' -DTRI_HAVE_ICU=1"
fi

dnl ----------------------------------------------------------------------------
dnl add substitutions
dnl ----------------------------------------------------------------------------

AC_SUBST(ICU_CPPFLAGS)
AC_SUBST(ICU_LDFLAGS)
AC_SUBST(ICU_LIBS)

dnl ----------------------------------------------------------------------------
dnl informational output
dnl ----------------------------------------------------------------------------

LIB_INFO="$LIB_INFO|."
if test "x$tr_ICU" = xyes;  then
  LIB_INFO="$LIB_INFO|ICU VERSION: ${TRI_ICU_VERSION}"

  LIB_INFO="$LIB_INFO|ICU_CPPFLAGS: ${ICU_CPPFLAGS}"
  LIB_INFO="$LIB_INFO|ICU_LDFLAGS:  ${ICU_LDFLAGS}"
  LIB_INFO="$LIB_INFO|ICU_LIBS:     ${ICU_LIBS}"
else
  LIB_INFO="$LIB_INFO|ICU: disabled"
fi

LIB_INFO="$LIB_INFO|."

dnl ----------------------------------------------------------------------------
dnl --SECTION--                                                      END-OF-FILE
dnl ----------------------------------------------------------------------------

dnl Local Variables:
dnl mode: outline-minor
dnl outline-regexp: "^\\(dnl --SECTION--\\)"
dnl End:
